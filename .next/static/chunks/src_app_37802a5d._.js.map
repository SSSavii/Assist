{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/georgiiisavich/Desktop/assist_plus/src/app/components/Avatar.tsx"],"sourcesContent":["import React from 'react';\n\nconst getInitials = (firstName: string, lastName: string | null) => {\n  const firstInitial = firstName ? firstName[0] : '';\n  const lastInitial = lastName ? lastName[0] : '';\n  return `${firstInitial}${lastInitial}`.toUpperCase();\n};\n\nconst avatarColors = [\n  '#ef4444', '#f97316', '#eab308', \n  '#84cc16', '#22c55e', '#10b981', \n  '#06b6d4', '#3b82f6', '#8b5cf6', \n  '#d946ef', '#ec4899'\n];\n\ninterface AvatarProps {\n  firstName: string;\n  lastName: string | null;\n  className?: string;\n  style?: React.CSSProperties;\n}\n\nconst Avatar: React.FC<AvatarProps> = ({ firstName, lastName, className = '', style }) => {\n  const initials = getInitials(firstName, lastName);\n\n  const colorIndex = (firstName.charCodeAt(0) || 0) % avatarColors.length;\n  const backgroundColor = avatarColors[colorIndex];\n\n  return (\n    <div\n      className={`w-16 h-16 rounded-full flex items-center justify-center \n                  bg-gray-300 text-white font-bold text-lg border-2 border-white \n                  flex-shrink-0 ${className}`}\n      style={{ backgroundColor, ...style }}\n      title={`${firstName} ${lastName || ''}`}\n    >\n      {initials}\n    </div>\n  );\n};\n\nexport default Avatar;"],"names":[],"mappings":";;;;;AAEA,MAAM,cAAc,CAAC,WAAmB;IACtC,MAAM,eAAe,YAAY,SAAS,CAAC,EAAE,GAAG;IAChD,MAAM,cAAc,WAAW,QAAQ,CAAC,EAAE,GAAG;IAC7C,OAAO,GAAG,eAAe,aAAa,CAAC,WAAW;AACpD;AAEA,MAAM,eAAe;IACnB;IAAW;IAAW;IACtB;IAAW;IAAW;IACtB;IAAW;IAAW;IACtB;IAAW;CACZ;AASD,MAAM,SAAgC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,YAAY,EAAE,EAAE,KAAK,EAAE;IACnF,MAAM,WAAW,YAAY,WAAW;IAExC,MAAM,aAAa,CAAC,UAAU,UAAU,CAAC,MAAM,CAAC,IAAI,aAAa,MAAM;IACvE,MAAM,kBAAkB,YAAY,CAAC,WAAW;IAEhD,qBACE,6LAAC;QACC,WAAW,CAAC;;gCAEc,EAAE,WAAW;QACvC,OAAO;YAAE;YAAiB,GAAG,KAAK;QAAC;QACnC,OAAO,GAAG,UAAU,CAAC,EAAE,YAAY,IAAI;kBAEtC;;;;;;AAGP;KAjBM;uCAmBS","debugId":null}},
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file:///Users/georgiiisavich/Desktop/assist_plus/src/app/%28main%29/friends/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport Avatar from '../../components/Avatar';\nimport Image from 'next/image';\n\ntype UserProfile = {\n  id: number;\n  balance_crystals: number;\n};\n\ntype Referral = {\n  id: number;\n  first_name: string;\n  last_name: string | null;\n};\n\nconst MY_ICON_PATH = '/images/134.png';\n\nexport default function FriendsPage() {\n  const [user, setUser] = useState<UserProfile | null>(null);\n  const [referrals, setReferrals] = useState<Referral[]>([]);\n  const [error, setError] = useState<string | null>(null);\n  const [loading, setLoading] = useState(true); // Будем показывать \"Загрузка...\" до готовности WebApp\n  const [isClient, setIsClient] = useState(false); // ← Ключевая фиксация гидратации\n  const [showRules, setShowRules] = useState(false);\n\n  // 1. Убедимся, что мы только на клиенте\n  useEffect(() => {\n    setIsClient(true); // Это гарантирует, что рендер после монтирования\n  }, []);\n\n  // 2. Только на клиенте — инициализируем Telegram\n  useEffect(() => {\n    if (!isClient) return;\n\n    const tg = window.Telegram?.WebApp;\n    if (!tg) {\n      setError('Telegram WebApp недоступен');\n      setLoading(false);\n      return;\n    }\n\n    tg.ready();\n\n    const initData = tg.initData;\n    if (!initData) {\n      setError('initData отсутствует');\n      setLoading(false);\n      return;\n    }\n\n    console.log('[Friends] Запрос к /api/auth...');\n    fetch('/api/auth', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ initData }),\n    })\n      .then(async (res) => {\n        if (!res.ok) throw new Error(`Auth: ${res.status} ${await res.text()}`);\n        return res.json();\n      })\n      .then((userData) => {\n        setUser(userData);\n        return fetch('/api/referrals', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ initData }),\n        });\n      })\n      .then(async (res) => {\n        if (!res.ok) throw new Error(`Referrals: ${res.status} ${await res.text()}`);\n        return res.json();\n      })\n      .then((data) => {\n        setReferrals(Array.isArray(data) ? data : []);\n      })\n      .catch((err) => {\n        console.error('Ошибка в FriendsPage:', err);\n        setError(err.message || 'Не удалось загрузить данные');\n      })\n      .finally(() => {\n        setLoading(false);\n      });\n  }, [isClient]);\n\n  if (!isClient) {\n    // Пока клиент не готов — ничего не рендерим (или заглушка)\n    return <div className=\"h-screen bg-white\"></div>;\n  }\n\n  if (loading) {\n    return (\n      <div className=\"flex justify-center items-center h-screen bg-white\">\n        Загрузка...\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"p-6 text-center text-red-500\">\n        <p><strong>Ошибка:</strong> {error}</p>\n        <button\n          onClick={() => window.location.reload()}\n          className=\"mt-4 px-4 py-2 bg-red-500 text-white rounded\"\n        >\n          Перезагрузить\n        </button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex flex-col min-h-screen font-['Unbounded'] bg-white\">\n      {/* Кнопка с правилами */}\n      <div className=\"px-6 pt-4 pb-2\">\n        <button\n          onClick={() => setShowRules(true)}\n          className=\"w-full text-left text-sm text-blue-500 underline font-medium\"\n        >\n          Условия розыгрышей и бонусов\n        </button>\n      </div>\n\n      <main className=\"flex-grow flex flex-col items-center px-6 pt-0 pb-4\">\n        <Image src={MY_ICON_PATH} alt=\"Кристалл\" width={180} height={180} />\n\n        <h1 className=\"text-2xl text-black font-extrabold leading-tight mb-6\">\n          Приглашай<br />друзей и получай<br />плюсы\n        </h1>\n\n        <div className=\"w-full max-w-sm mb-6 bg-gray-50 rounded-2xl p-4 border border-gray-100\">\n          <h2 className=\"text-lg font-bold text-black mb-3 text-left\">\n            Вы пригласили: <span className=\"text-red-500\">{referrals.length}</span>\n          </h2>\n\n          {referrals.length > 0 ? (\n            <div className=\"flex flex-nowrap items-center overflow-x-auto py-2 pl-1 pr-4 space-x-[-16px] [&::-webkit-scrollbar]:hidden\">\n              {referrals.map((ref) => (\n                <Avatar\n                  key={ref.id}\n                  firstName={ref.first_name}\n                  lastName={ref.last_name}\n                />\n              ))}\n            </div>\n          ) : (\n            <p className=\"text-gray-500 text-sm text-left\">Пока никто не присоединился</p>\n          )}\n        </div>\n      </main>\n\n      <footer className=\"w-full px-6 pb-6\">\n        <button\n  onClick={() => {\n    const tg = window.Telegram?.WebApp;\n    \n    if (!tg) {\n      // Невозможно показать tg.showAlert, потому что tg нет\n      console.error('Telegram WebApp недоступен');\n      alert('Ошибка: приложение должно запускаться в Telegram');\n      return;\n    }\n\n    const botUsername = process.env.NEXT_PUBLIC_TELEGRAM_BOT_USERNAME;\n    const botName = process.env.NEXT_PUBLIC_TELEGRAM_BOT_NAME;\n\n    if (!botUsername || !botName) {\n      tg.showAlert('Ошибка: конфигурация приложения');\n      return;\n    }\n\n    if (!user?.id) {\n      tg.showAlert('Ошибка: пользователь не загружен');\n      return;\n    }\n\n    const referralLink = `https://t.me/${botUsername}/${botName}?startapp=ref_${user.id}`;\n    const shareText = `Привет! Присоединяйся к \"Ассист+\" и получай бонусы.`;\n    const shareUrl = `https://t.me/share/url?url=${encodeURIComponent(referralLink)}&text=${encodeURIComponent(shareText)}`;\n\n    tg.openTelegramLink(shareUrl);\n  }}\n  className=\"w-full h-16 flex items-center justify-center bg-red-500 text-white text-lg gap-2 font-medium rounded-2xl active:translate-y-1\"\n>\n  <span>Пригласить друга</span>\n  <div\n    className=\"w-5 h-5 bg-white\"\n    style={{\n      maskImage: `url(${MY_ICON_PATH})`,\n      WebkitMaskImage: `url(${MY_ICON_PATH})`,\n      maskSize: 'contain',\n      maskRepeat: 'no-repeat',\n      maskPosition: 'center',\n    }}\n  />\n  <span>500</span>\n</button>\n      </footer>\n\n      {/* Модальное окно */}\n      {showRules && (\n        <div\n          className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\"\n          onClick={() => setShowRules(false)}\n        >\n          <div\n            className=\"bg-white rounded-2xl p-5 max-w-sm w-full\"\n            onClick={(e) => e.stopPropagation()}\n          >\n            <h3 className=\"text-lg font-bold text-black mb-3\">Условия участия</h3>\n            <ul className=\"text-sm text-gray-700 space-y-2\">\n              <li>• 10 приглашений — онлайн-разбор с Иваном Абрамовым</li>\n              <li>• 20 приглашений — приоритетное участие</li>\n              <li>• 30 приглашений — завтрак в Сколково</li>\n            </ul>\n            <button\n              onClick={() => setShowRules(false)}\n              className=\"mt-4 w-full py-2 bg-gray-200 text-black rounded-xl\"\n            >\n              Понятно\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}