{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/georgiiisavich/Desktop/assist_plus/src/app/components/CountdownTimer.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useRef } from 'react';\n\nconst padWithZero = (num: number) => num.toString().padStart(2, '0');\n\nconst calculateTimeLeft = (expiryDate: string) => {\n  const difference = +new Date(expiryDate) - +new Date();\n  let timeLeft = { hours: 0, minutes: 0, seconds: 0 };\n\n  if (difference > 0) {\n    timeLeft = {\n      hours: Math.floor(difference / (1000 * 60 * 60)),\n      minutes: Math.floor((difference / 1000 / 60) % 60),\n      seconds: Math.floor((difference / 1000) % 60),\n    };\n  }\n  return timeLeft;\n};\n\ninterface CountdownTimerProps {\n  expiryDate: string;\n  onTimeUp?: () => void;\n}\n\nexport default function CountdownTimer({ expiryDate, onTimeUp }: CountdownTimerProps) {\n  const [timeLeft, setTimeLeft] = useState(calculateTimeLeft(expiryDate));\n  const timeUpReported = useRef(false); \n\n  useEffect(() => {\n    const timer = setInterval(() => {\n      const newTimeLeft = calculateTimeLeft(expiryDate);\n      setTimeLeft(newTimeLeft);\n\n      const isTimeUpNow = !newTimeLeft.hours && !newTimeLeft.minutes && !newTimeLeft.seconds;\n      if (isTimeUpNow && onTimeUp && !timeUpReported.current) {\n        onTimeUp();\n        timeUpReported.current = true;\n      }\n\n    }, 1000);\n\n    return () => clearInterval(timer);\n  }, [expiryDate, onTimeUp]);\n\n  const timerComponents = [\n    padWithZero(timeLeft.hours),\n    padWithZero(timeLeft.minutes),\n    padWithZero(timeLeft.seconds),\n  ];\n  \n  const isTimeUp = !timeLeft.hours && !timeLeft.minutes && !timeLeft.seconds;\n\n  return (\n    <div className={`font-mono text-xl ${isTimeUp ? 'text-gray-400' : 'text-gray-800'}`}>\n      {isTimeUp ? 'Завершен' : timerComponents.join(':')}\n    </div>\n  );\n}"],"names":[],"mappings":";;;;AAEA;;;AAFA;;AAIA,MAAM,cAAc,CAAC,MAAgB,IAAI,QAAQ,GAAG,QAAQ,CAAC,GAAG;AAEhE,MAAM,oBAAoB,CAAC;IACzB,MAAM,aAAa,CAAC,IAAI,KAAK,cAAc,CAAC,IAAI;IAChD,IAAI,WAAW;QAAE,OAAO;QAAG,SAAS;QAAG,SAAS;IAAE;IAElD,IAAI,aAAa,GAAG;QAClB,WAAW;YACT,OAAO,KAAK,KAAK,CAAC,aAAa,CAAC,OAAO,KAAK,EAAE;YAC9C,SAAS,KAAK,KAAK,CAAC,AAAC,aAAa,OAAO,KAAM;YAC/C,SAAS,KAAK,KAAK,CAAC,AAAC,aAAa,OAAQ;QAC5C;IACF;IACA,OAAO;AACT;AAOe,SAAS,eAAe,EAAE,UAAU,EAAE,QAAQ,EAAuB;;IAClF,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE,kBAAkB;IAC3D,MAAM,iBAAiB,CAAA,GAAA,6JAAA,CAAA,SAAM,AAAD,EAAE;IAE9B,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;oCAAE;YACR,MAAM,QAAQ;kDAAY;oBACxB,MAAM,cAAc,kBAAkB;oBACtC,YAAY;oBAEZ,MAAM,cAAc,CAAC,YAAY,KAAK,IAAI,CAAC,YAAY,OAAO,IAAI,CAAC,YAAY,OAAO;oBACtF,IAAI,eAAe,YAAY,CAAC,eAAe,OAAO,EAAE;wBACtD;wBACA,eAAe,OAAO,GAAG;oBAC3B;gBAEF;iDAAG;YAEH;4CAAO,IAAM,cAAc;;QAC7B;mCAAG;QAAC;QAAY;KAAS;IAEzB,MAAM,kBAAkB;QACtB,YAAY,SAAS,KAAK;QAC1B,YAAY,SAAS,OAAO;QAC5B,YAAY,SAAS,OAAO;KAC7B;IAED,MAAM,WAAW,CAAC,SAAS,KAAK,IAAI,CAAC,SAAS,OAAO,IAAI,CAAC,SAAS,OAAO;IAE1E,qBACE,6LAAC;QAAI,WAAW,CAAC,kBAAkB,EAAE,WAAW,kBAAkB,iBAAiB;kBAChF,WAAW,aAAa,gBAAgB,IAAI,CAAC;;;;;;AAGpD;GAjCwB;KAAA","debugId":null}},
    {"offset": {"line": 86, "column": 0}, "map": {"version":3,"sources":["file:///Users/georgiiisavich/Desktop/assist_plus/src/app/components/DecorativeShape.tsx"],"sourcesContent":["'use client';\n\ninterface DecorativeShapeProps {\n  iconPath: string;\n  className: string;\n}\n\nexport default function DecorativeShape({ iconPath, className }: DecorativeShapeProps) {\n  return (\n    <div\n      className={`absolute bg-gray-300 ${className}`}\n      style={{\n        maskImage: `url(${iconPath})`,\n        WebkitMaskImage: `url(${iconPath})`,\n        maskSize: 'contain',\n        maskRepeat: 'no-repeat',\n        maskPosition: 'center',\n      }}\n    />\n  );\n}"],"names":[],"mappings":";;;;AAAA;;AAOe,SAAS,gBAAgB,EAAE,QAAQ,EAAE,SAAS,EAAwB;IACnF,qBACE,6LAAC;QACC,WAAW,CAAC,qBAAqB,EAAE,WAAW;QAC9C,OAAO;YACL,WAAW,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;YAC7B,iBAAiB,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;YACnC,UAAU;YACV,YAAY;YACZ,cAAc;QAChB;;;;;;AAGN;KAbwB","debugId":null}},
    {"offset": {"line": 120, "column": 0}, "map": {"version":3,"sources":["file:///Users/georgiiisavich/Desktop/assist_plus/src/app/components/LotCard.tsx"],"sourcesContent":["'use client';\n\nimport Image from 'next/image';\nimport Link from 'next/link';\nimport CountdownTimer from './CountdownTimer';\nimport DecorativeShape from './DecorativeShape';\n\ninterface Lot {\n  id: number;\n  title: string;\n  photoUrl: string | null;\n  current_price: number;\n  winner_id: number | null;\n  expires_at: string;\n}\n\nconst formatPrice = (price: number) => new Intl.NumberFormat('ru-RU').format(price);\n\ninterface LotCardProps {\n  lot: Lot;\n  currentUserId: number | null;\n}\n\nexport default function LotCard({ lot, currentUserId }: LotCardProps) {\n  const isMyBid = lot.winner_id === currentUserId;\n\n  const imageUrl = lot.photoUrl\n    ? `${process.env.NEXT_PUBLIC_APP_URL}${lot.photoUrl}`\n    : '/images/placeholder.png';\n\n  return (\n    <Link \n      href={`/lots/${lot.id}`}\n      className={`relative block overflow-hidden p-4 bg-white border-2 rounded-2xl text-center w-full h-full transition-transform active:scale-95 ${isMyBid ? 'border-green-500' : 'border-red-500'}`}\n    >\n      <DecorativeShape iconPath=\"/decor/star.svg\" className=\"w-42 h-42 top-[-40px] left-[-50px] opacity-20 rotate-[-15deg] z-0\" />\n      <DecorativeShape iconPath=\"/decor/plus.svg\" className=\"w-28 h-28 bottom-[-15px] right-[-30px] opacity-30 rotate-[25deg] z-0\" />\n\n      <div className=\"relative z-10 flex flex-col h-full\">\n        <div className=\"relative w-24 h-24 mb-3 rounded-full overflow-hidden mx-auto\">\n          <Image src={imageUrl} alt={lot.title} className=\"object-cover\" fill sizes=\"96px\" />\n        </div>\n\n        <div className=\"flex-grow flex items-center justify-center\">\n          <p className=\"font-semibold text-base leading-tight\">\n            {lot.title}\n          </p>\n        </div>\n\n        <div className=\"mt-3\">\n          <CountdownTimer expiryDate={lot.expires_at} />\n        </div>\n        \n        <div className=\"flex items-center justify-center mt-1 text-xl font-bold\">\n          <span>{formatPrice(lot.current_price)}</span>\n          <div className=\"ml-1.5 h-6 w-6 bg-red-500\" style={{ maskImage: 'url(/images/crystal.png)', WebkitMaskImage: 'url(/images/crystal.png)', maskSize: 'contain', maskRepeat: 'no-repeat' }}/>\n        </div>\n      </div>\n    </Link>\n  );\n}"],"names":[],"mappings":";;;AA2BS;;AAzBT;AACA;AACA;AACA;AALA;;;;;;AAgBA,MAAM,cAAc,CAAC,QAAkB,IAAI,KAAK,YAAY,CAAC,SAAS,MAAM,CAAC;AAO9D,SAAS,QAAQ,EAAE,GAAG,EAAE,aAAa,EAAgB;IAClE,MAAM,UAAU,IAAI,SAAS,KAAK;IAElC,MAAM,WAAW,IAAI,QAAQ,GACzB,GAAG,gKAAA,CAAA,UAAO,CAAC,GAAG,CAAC,mBAAmB,GAAG,IAAI,QAAQ,EAAE,GACnD;IAEJ,qBACE,6LAAC,+JAAA,CAAA,UAAI;QACH,MAAM,CAAC,MAAM,EAAE,IAAI,EAAE,EAAE;QACvB,WAAW,CAAC,gIAAgI,EAAE,UAAU,qBAAqB,kBAAkB;;0BAE/L,6LAAC,+IAAA,CAAA,UAAe;gBAAC,UAAS;gBAAkB,WAAU;;;;;;0BACtD,6LAAC,+IAAA,CAAA,UAAe;gBAAC,UAAS;gBAAkB,WAAU;;;;;;0BAEtD,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC,gIAAA,CAAA,UAAK;4BAAC,KAAK;4BAAU,KAAK,IAAI,KAAK;4BAAE,WAAU;4BAAe,IAAI;4BAAC,OAAM;;;;;;;;;;;kCAG5E,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BAAE,WAAU;sCACV,IAAI,KAAK;;;;;;;;;;;kCAId,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC,8IAAA,CAAA,UAAc;4BAAC,YAAY,IAAI,UAAU;;;;;;;;;;;kCAG5C,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;0CAAM,YAAY,IAAI,aAAa;;;;;;0CACpC,6LAAC;gCAAI,WAAU;gCAA4B,OAAO;oCAAE,WAAW;oCAA4B,iBAAiB;oCAA4B,UAAU;oCAAW,YAAY;gCAAY;;;;;;;;;;;;;;;;;;;;;;;;AAK/L;KArCwB","debugId":null}},
    {"offset": {"line": 263, "column": 0}, "map": {"version":3,"sources":["file:///Users/georgiiisavich/Desktop/assist_plus/src/app/%28main%29/lots/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState, useMemo } from 'react';\nimport { useRouter } from 'next/navigation';\nimport LotCard from 'wxqryy/app/components/LotCard'; \nimport { ArrowDownUp } from 'lucide-react';\n\ninterface Lot {\n  id: number;\n  title: string;\n  photoUrl: string | null;\n  current_price: number;\n  winner_id: number | null;\n  expires_at: string;\n}\n\ninterface User {\n  id: number;\n  balance_crystals: number;\n}\n\nexport default function LotsPage() {\n  const router = useRouter();\n  const [lots, setLots] = useState<Lot[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [currentUser, setCurrentUser] = useState<User | null>(null);\n  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('desc');\n\n  const fetchLots = async () => {\n    try {\n      const response = await fetch('/api/lots');\n      if (!response.ok) throw new Error('Ошибка сети при загрузке лотов');\n      const data: Lot[] = await response.json();\n      setLots(data);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Произошла ошибка');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    const tg = window.Telegram?.WebApp;\n    if (tg) {\n      tg.ready();\n      fetch('/api/auth', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ initData: tg.initData }),\n      })\n      .then(res => res.json())\n      .then(data => {\n        if (data.error) {\n          setError(data.error);\n        } else {\n          setCurrentUser(data);\n        }\n      })\n      .catch(err => setError(err.message));\n    }\n    \n    fetchLots();\n\n    const handleBackClick = () => router.back();\n    tg?.BackButton.show();\n    tg?.BackButton.onClick(handleBackClick);\n    return () => {\n      tg?.BackButton.offClick(handleBackClick);\n      tg?.BackButton.hide();\n    };\n  }, [router]);\n\n  const toggleSortOrder = () => {\n    setSortOrder(currentOrder => (currentOrder === 'asc' ? 'desc' : 'asc'));\n  };\n\n  const sortedLots = useMemo(() => {\n    return [...lots].sort((a, b) => {\n      if (sortOrder === 'asc') {\n        return a.current_price - b.current_price;\n      } else {\n        return b.current_price - a.current_price;\n      }\n    });\n  }, [lots, sortOrder]);\n\n\nreturn (\n    <div className=\"relative p-4 bg-white min-h-screen text-black overflow-hidden\">\n      \n      <div className=\"relative z-10\">\n        <div className=\"flex justify-between items-center mb-6\">\n          <h1 className=\"text-3xl font-bold\">Аукцион</h1>\n          \n          <button\n            onClick={toggleSortOrder}\n            className=\"flex items-center gap-2 px-3 py-2 bg-gray-100 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors\"\n          >\n            <ArrowDownUp size={16} />\n            <span>\n              {sortOrder === 'asc' ? 'По возрастанию' : 'По убыванию'}\n            </span>\n          </button>\n        </div>\n        \n        {loading && <p className=\"text-center\">Загрузка...</p>}\n        {error && <p className=\"text-center text-red-500\">Ошибка: {error}</p>}\n        \n        {!loading && !error && (\n          <div className=\"grid grid-cols-2 gap-4\">\n            {sortedLots.map(lot => (\n              <LotCard \n                key={lot.id} \n                lot={lot}\n                currentUserId={currentUser?.id || null}\n              />\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}