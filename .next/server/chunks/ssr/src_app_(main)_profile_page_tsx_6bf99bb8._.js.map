{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/georgiiisavich/Desktop/assist_plus/src/app/%28main%29/profile/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport Link from 'next/link';\nimport Image from 'next/image';\nimport {\n  Users,\n  ChevronRight,\n  Medal,\n  UserCircle,\n  Pencil,\n  Wallet,\n} from 'lucide-react';\n\ntype UserProfile = {\n  id: number;\n  first_name: string;\n  last_name?: string;\n  username?: string;\n  photo_url?: string;\n  balance_crystals: number;\n};\n\ninterface ProfileLinkProps {\n  icon: React.ElementType;\n  iconBgColor: string;\n  text: string;\n  subText?: string;\n  href: string;\n}\n\nfunction ProfileLink({ icon: Icon, iconBgColor, text, subText, href }: ProfileLinkProps) {\n  return (\n    <Link\n      href={href}\n      className=\"flex items-center w-full p-3 bg-gray-100 rounded-lg transition-colors hover:bg-gray-200 active:bg-gray-300\"\n    >\n      <div className={`p-2 rounded-md ${iconBgColor}`}>\n        <Icon className=\"h-5 w-5 text-white\" />\n      </div>\n      <span className=\"ml-4 font-semibold flex-grow\">{text}</span>\n      {subText && <span className=\"text-gray-500 mr-2\">{subText}</span>}\n      <ChevronRight className=\"h-5 w-5 text-gray-400\" />\n    </Link>\n  );\n}\n\ninterface BalanceDisplayProps {\n    icon: React.ElementType;\n    iconBgColor: string;\n    text: string;\n    balance: number;\n}\n\nfunction BalanceDisplay({ icon: Icon, iconBgColor, text, balance }: BalanceDisplayProps) {\n    return (\n        <div className=\"flex items-center w-full p-3 bg-gray-100 rounded-lg\">\n            <div className={`p-2 rounded-md ${iconBgColor}`}>\n                <Icon className=\"h-5 w-5 text-white\" />\n            </div>\n            <span className=\"ml-4 font-semibold flex-grow\">{text}</span>\n            <span className=\"font-bold text-lg\">{balance.toLocaleString('ru-RU')}</span>\n        </div>\n    );\n}\n\n\nexport default function ProfilePage() {\n  const [user, setUser] = useState<UserProfile | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    const tg = window.Telegram?.WebApp;\n    if (tg) {\n      tg.ready();\n      fetch('/api/auth', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ initData: tg.initData }),\n      })\n      .then(response => {\n        if (!response.ok) throw new Error('Не удалось загрузить данные пользователя');\n        return response.json();\n      })\n      .then(data => {\n        if (data && data.error) {\n            throw new Error(data.error);\n        }\n        const fullUserData = {\n            ...data,\n            photo_url: tg.initDataUnsafe?.user?.photo_url,\n        };\n        setUser(fullUserData);\n      })\n      .catch(err => {\n        console.error(\"Profile fetch error:\", err);\n        setError(err.message);\n      })\n      .finally(() => setLoading(false));\n    } else {\n        setLoading(false);\n        setError(\"Приложение необходимо открыть в Telegram\");\n    }\n  }, []);\n\n  if (loading) {\n    return (\n      <div className=\"flex justify-center items-center h-full bg-white\">\n        <p className=\"text-gray-500\">Загрузка данных профиля...</p>\n      </div>\n    );\n  }\n\n  if (error || !user) {\n      return (\n        <div className=\"flex justify-center items-center h-full bg-white\">\n            <p className=\"text-red-500\">{error || \"Не удалось загрузить профиль.\"}</p>\n        </div>\n      );\n  }\n\n  return (\n    <div className=\"flex flex-col items-center bg-white text-black p-4 pt-8\">\n      <div className=\"flex flex-col items-center\">\n        {user.photo_url ? (\n          <Image\n            src={user.photo_url}\n            alt=\"User Avatar\"\n            width={150}\n            height={150}\n            className=\"rounded-full\"\n          />\n        ) : (\n          <UserCircle className=\"h-24 w-24 text-gray-300\" />\n        )}\n        <h2 className=\"text-2xl font-bold mt-4\">\n          {user.first_name} {user.last_name || ''}\n        </h2>\n      </div>\n\n      <div className=\"w-full max-w-md mt-10 space-y-3\">\n        <BalanceDisplay \n            icon={Wallet}\n            iconBgColor=\"bg-green-500\"\n            text=\"Баланс\"\n            balance={user.balance_crystals}\n        />\n\n        <ProfileLink\n          icon={Pencil}\n          iconBgColor=\"bg-blue-500\"\n          text=\"Добавить описание\"\n          href=\"/profile/edit-bio\"\n        />\n\n        <ProfileLink\n          icon={Medal}\n          iconBgColor=\"bg-purple-500\"\n          text=\"Добавить достижения\"\n          href=\"/profile/edit-awards\"\n        />\n\n        <ProfileLink\n          icon={Users}\n          iconBgColor=\"bg-orange-500\"\n          text=\"Сообщество Assist+\"\n          href=\"\"\n        />\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}