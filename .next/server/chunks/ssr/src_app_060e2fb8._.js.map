{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/georgiiisavich/Desktop/assist_plus/src/app/components/Avatar.tsx"],"sourcesContent":["import React from 'react';\n\nconst getInitials = (firstName: string, lastName: string | null) => {\n  const firstInitial = firstName ? firstName[0] : '';\n  const lastInitial = lastName ? lastName[0] : '';\n  return `${firstInitial}${lastInitial}`.toUpperCase();\n};\n\nconst avatarColors = [\n  '#ef4444', '#f97316', '#eab308', \n  '#84cc16', '#22c55e', '#10b981', \n  '#06b6d4', '#3b82f6', '#8b5cf6', \n  '#d946ef', '#ec4899'\n];\n\ninterface AvatarProps {\n  firstName: string;\n  lastName: string | null;\n  className?: string;\n  style?: React.CSSProperties;\n}\n\nconst Avatar: React.FC<AvatarProps> = ({ firstName, lastName, className = '', style }) => {\n  const initials = getInitials(firstName, lastName);\n\n  const colorIndex = (firstName.charCodeAt(0) || 0) % avatarColors.length;\n  const backgroundColor = avatarColors[colorIndex];\n\n  return (\n    <div\n      className={`w-16 h-16 rounded-full flex items-center justify-center \n                  bg-gray-300 text-white font-bold text-lg border-2 border-white \n                  flex-shrink-0 ${className}`}\n      style={{ backgroundColor, ...style }}\n      title={`${firstName} ${lastName || ''}`}\n    >\n      {initials}\n    </div>\n  );\n};\n\nexport default Avatar;"],"names":[],"mappings":";;;;;AAEA,MAAM,cAAc,CAAC,WAAmB;IACtC,MAAM,eAAe,YAAY,SAAS,CAAC,EAAE,GAAG;IAChD,MAAM,cAAc,WAAW,QAAQ,CAAC,EAAE,GAAG;IAC7C,OAAO,GAAG,eAAe,aAAa,CAAC,WAAW;AACpD;AAEA,MAAM,eAAe;IACnB;IAAW;IAAW;IACtB;IAAW;IAAW;IACtB;IAAW;IAAW;IACtB;IAAW;CACZ;AASD,MAAM,SAAgC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,YAAY,EAAE,EAAE,KAAK,EAAE;IACnF,MAAM,WAAW,YAAY,WAAW;IAExC,MAAM,aAAa,CAAC,UAAU,UAAU,CAAC,MAAM,CAAC,IAAI,aAAa,MAAM;IACvE,MAAM,kBAAkB,YAAY,CAAC,WAAW;IAEhD,qBACE,8OAAC;QACC,WAAW,CAAC;;gCAEc,EAAE,WAAW;QACvC,OAAO;YAAE;YAAiB,GAAG,KAAK;QAAC;QACnC,OAAO,GAAG,UAAU,CAAC,EAAE,YAAY,IAAI;kBAEtC;;;;;;AAGP;uCAEe","debugId":null}},
    {"offset": {"line": 57, "column": 0}, "map": {"version":3,"sources":["file:///Users/georgiiisavich/Desktop/assist_plus/src/app/%28main%29/friends/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport Avatar from '../../components/Avatar';\nimport Image from 'next/image';\n\ntype UserProfile = {\n  id: number;\n  balance_crystals: number;\n};\n\ntype Referral = {\n  id: number;\n  first_name: string;\n  last_name: string | null;\n};\n\nconst MY_ICON_PATH = '/images/134.png';\n\nexport default function FriendsPage() {\n  const [user, setUser] = useState<UserProfile | null>(null);\n  const [referrals, setReferrals] = useState<Referral[]>([]);\n  const [error, setError] = useState<string | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [isClient, setIsClient] = useState(false);\n  const [showRules, setShowRules] = useState(false);\n\n  useEffect(() => {\n    setIsClient(true);\n  }, []);\n\n  useEffect(() => {\n    if (!isClient) return;\n\n    const tg = window.Telegram?.WebApp;\n    if (!tg) {\n      setError('Telegram WebApp недоступен');\n      setLoading(false);\n      return;\n    }\n\n    tg.ready();\n\n    const initData = tg.initData;\n    if (!initData) {\n      setError('initData отсутствует');\n      setLoading(false);\n      return;\n    }\n\n    console.log('[Friends] Запрос к /api/auth...');\n    fetch('/api/auth', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ initData }),\n    })\n      .then(async (res) => {\n        if (!res.ok) throw new Error(`Auth: ${res.status} ${await res.text()}`);\n        return res.json();\n      })\n      .then((userData) => {\n        setUser(userData);\n        return fetch('/api/referrals', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ initData }),\n        });\n      })\n      .then(async (res) => {\n        if (!res.ok) throw new Error(`Referrals: ${res.status} ${await res.text()}`);\n        return res.json();\n      })\n      .then((data) => {\n        setReferrals(Array.isArray(data) ? data : []);\n      })\n      .catch((err) => {\n        console.error('Ошибка в FriendsPage:', err);\n        setError(err.message || 'Не удалось загрузить данные');\n      })\n      .finally(() => {\n        setLoading(false);\n      });\n  }, [isClient]);\n\n  if (!isClient) {\n    return <div className=\"h-screen bg-white\"></div>;\n  }\n\n  if (loading) {\n    return (\n      <div className=\"flex justify-center items-center h-screen bg-white\">\n        Загрузка...\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"p-6 text-center text-red-500\">\n        <p><strong>Ошибка:</strong> {error}</p>\n        <button\n          onClick={() => window.location.reload()}\n          className=\"mt-4 px-4 py-2 bg-red-500 text-white rounded\"\n        >\n          Перезагрузить\n        </button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex flex-col min-h-screen font-['Unbounded'] bg-white\">\n      <main className=\"flex-grow flex flex-col items-center px-6 pt-6 pb-4\">\n        <Image src={MY_ICON_PATH} alt=\"Кристалл\" width={180} height={180} />\n\n        <h1 className=\"text-2xl text-black font-extrabold leading-tight mb-6 text-center\">\n          Приглашай<br />друзей и получай<br />плюсы\n        </h1>\n\n        {/* Красная кнопка с правилами - добавлена здесь */}\n        <button\n          onClick={() => setShowRules(true)}\n          className=\"w-full max-w-sm h-16 mb-6 flex items-center justify-center bg-red-500 text-white text-lg font-medium rounded-2xl \n                    transition-all shadow-[0_4px_0_0_rgba(0,0,0,0.3)] \n                    active:translate-y-1 active:shadow-[0_2px_0_0_rgba(0,0,0,0.3)]\"\n        >\n          Условия розыгрышей и бонусов\n        </button>\n\n        <div className=\"w-full max-w-sm mb-6 bg-gray-50 rounded-2xl p-4 border border-gray-100\">\n          <h2 className=\"text-lg font-bold text-black mb-3 text-left\">\n            Вы пригласили: <span className=\"text-red-500\">{referrals.length}</span>\n          </h2>\n\n          {referrals.length > 0 ? (\n            <div className=\"flex flex-nowrap items-center overflow-x-auto py-2 pl-1 pr-4 space-x-[-16px] [&::-webkit-scrollbar]:hidden\">\n              {referrals.map((ref) => (\n                <Avatar\n                  key={ref.id}\n                  firstName={ref.first_name}\n                  lastName={ref.last_name}\n                />\n              ))}\n            </div>\n          ) : (\n            <p className=\"text-gray-500 text-sm text-left\">Пока никто не присоединился</p>\n          )}\n        </div>\n      </main>\n\n      <footer className=\"w-full px-6 pb-6\">\n        <button\n          onClick={() => {\n            const tg = window.Telegram?.WebApp;\n            \n            if (!tg) {\n              console.error('Telegram WebApp недоступен');\n              alert('Ошибка: приложение должно запускаться в Telegram');\n              return;\n            }\n\n            const botUsername = process.env.NEXT_PUBLIC_TELEGRAM_BOT_USERNAME;\n            const botName = process.env.NEXT_PUBLIC_TELEGRAM_BOT_NAME;\n\n            if (!botUsername || !botName) {\n              tg.showAlert('Ошибка: конфигурация приложения');\n              return;\n            }\n\n            if (!user?.id) {\n              tg.showAlert('Ошибка: пользователь не загружен');\n              return;\n            }\n\n            const referralLink = `https://t.me/${botUsername}/${botName}?startapp=ref_${user.id}`;\n            const shareText = `Привет! Присоединяйся к \"Ассист+\" и получай бонусы.`;\n            const shareUrl = `https://t.me/share/url?url=${encodeURIComponent(referralLink)}&text=${encodeURIComponent(shareText)}`;\n\n            tg.openTelegramLink(shareUrl);\n          }}\n          className=\"w-full h-16 flex items-center justify-center bg-red-500 text-white text-lg gap-2 font-medium rounded-2xl \n                    transition-all shadow-[0_4px_0_0_rgba(0,0,0,0.3)] \n                    active:translate-y-1 active:shadow-[0_2px_0_0_rgba(0,0,0,0.3)]\"\n        >\n          <span>Пригласить друга</span>\n          <div\n            className=\"w-5 h-5 bg-white\"\n            style={{\n              maskImage: `url(${MY_ICON_PATH})`,\n              WebkitMaskImage: `url(${MY_ICON_PATH})`,\n              maskSize: 'contain',\n              maskRepeat: 'no-repeat',\n              maskPosition: 'center',\n            }}\n          />\n          <span>500</span>\n        </button>\n      </footer>\n\n      {/* Модальное окно с правилами */}\n      {showRules && (\n        <div\n          className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\"\n          onClick={() => setShowRules(false)}\n        >\n          <div\n            className=\"bg-white rounded-2xl p-5 max-w-sm w-full\"\n            onClick={(e) => e.stopPropagation()}\n          >\n            <h3 className=\"text-lg font-bold text-black mb-3\">Условия участия</h3>\n            <ul className=\"text-sm text-gray-700 space-y-2\">\n              <li>• 10 приглашений — возможность попасть на онлайн мини-разбор с Иваном Абрамовым. Разбор проводится еженедельно.</li>\n              <li>• 20 приглашений — приоритетное место на мини-разборе, что гарантирует 100% участие в ближайшей сессии.</li>\n              <li>• 30 приглашений — участие в ежемесячном розыгрыше завтрака с Иваном Абрамовым в Сколково.</li>\n            </ul>\n            <button\n              onClick={() => setShowRules(false)}\n              className=\"mt-4 w-full py-2 bg-red-500 text-white rounded-xl font-medium\"\n            >\n              Понятно\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}